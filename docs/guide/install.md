---
outline: deep
---

# 安装与基本使用

<Badges name="shiki" />

## 安装

你可以通过 npm 仓库安装 Shiki，或者[使用 CDN](#使用-cdn)：
::: code-group

```sh [npm]
npm install -D shiki
```

```sh [yarn]
yarn add -D shiki
```

```sh [pnpm]
pnpm add -D shiki
```

```sh [bun]
bun add -D shiki
```

```sh [deno]
deno add npm:shiki
```

:::

## 使用集成

我们还提供了一些集成插件：

- [markdown-it 插件](/packages/markdown-it)
- [Rehype 插件](/packages/rehype)
- [TypeScript Twoslash 集成](/packages/twoslash)
- [Monaco Editor 语法高亮](/packages/monaco)
- [CLI 工具](/packages/cli)
- [常用变换器](/packages/transformers)

## 使用方法

### 简写函数

使用 `shiki` 最快的方式是使用简写，它们会按需加载必要的主题和语言，并自动在内存中缓存。

将代码片段传入 `codeToHtml` 函数，并指定 `lang` 和 `theme`，它将会返回一个高亮的 HTML 字符串，你可以直接将它们嵌入页面中。这些生成的 HTML 包含每个 token 的内联样式，因此无需额外的 CSS 即可渲染所有的样式。

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"3c8e529eec361d6e8df9dd502f896b689a8a3bc4756e1a8abbeda93600b43791","data":"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="}
import { codeToHtml } from 'shiki'

const code = 'const a = 1' // 输入代码
const html = await codeToHtml(code, {
  lang: 'javascript',
  theme: 'vitesse-dark'
})

console.log(html) // 高亮后的 HTML 字符串
```

你也可以使用 `codeToTokens` 或 `codeToHast` 获取中间数据结构，然后自行渲染：

```ts twoslash theme:min-dark
// @twoslash-cache: {"v":1,"hash":"b815da6ae7b98fc8742ecce6129ff09de56b53a6198bbf341d9bfeceb03a3cda","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AKAQwBsBLZuASgAIBjCGDhoB0GABUIUgNYxhiXo0GxFI0uzABzCrwhY07IXEUBhcVNny4AeQNHhAHgBCAVzBRWMKABlm212YtGF03Dy8oCXwYAFsYAD4+AF543gAFUggY9jgYRythACV4V1Y0eIAdMHYYrAhSURVJaQg5YUoQEWYGpABOKi9tNHwkAEYAJio0buCGRBAmy1brDo4wXEQABip+fG7mfhpyRF6AXwp0bA2CYjIOmno8QWFRNGWFXijY7wLkAF1/h0oBB+Ah5uMACK8bqkZgYPQAM14bzacF0CPYpBEvCgNWsDl4OV4a3gulyzygOLxwgJRJR1kJYGhxM0MAAdB0uj1EAAWABsA3kWmGSAF1BmMDm1HeCAGrKQkwWe1hhzuiAAHOdLjg8IQSOQpnQpSwOFw+IsWqjlOI1GgNNpdPpDMYzBZLdY7M6nGFPN4/AEgiFeD6Il84olFBksjk8gU4MU4KVylUanUGmJYEtUZzpty+QBmQVDEaICZTCVSi1x1byxCK3b7VXHcYAVi11CuutuBuoRqYWEyOAaGD4rH8WgA/IoQ37x4FgrwAD68ADKOH4nFY/q085gS947lgGPWUBz3Tmo1G2xAg2FJZ55dIszwY+0NfWSELSsbRwV7cwOrzHqdyGo88yMAO+hkJgfDmLAnoOHAK6aFoXhhnkM6RNE4ZssM3yKOhxRaDkdrMF6ACCYDwsuK52ihPjsEcbAAKrVEILiHqG2FBuoKHxGe3ITGKt4iogLaPs+8x4XE74bA+34qr+danH8OziHgqb1KIwAZs0ca8KcvAIpkMS8AA5HA+DsDI7BmVUVTPNiOn0sIBm8Ek0IAO7MIxulZtYjBmY4uJEAIY5wHASQVCACIQBA0XxAARt0jgAPQhfEZm6MAVS8MS46KGZ+BoDErBZblyLcYV2RgAAtFA3QyHZYCnNwHRxNMSCgEa+JCHgaAIKcpxAA="}
import { codeToTokens } from 'shiki'

const { tokens } = await codeToTokens('<div class="foo">bar</div>', {
  lang: 'html',
  theme: 'min-dark'
})
```

```ts twoslash theme:catppuccin-mocha
// @twoslash-cache: {"v":1,"hash":"c2d38cc11de83aa2f1d11651d47d604c307a1a81460c52619a8483484bbcdeb6","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AKAQwBsBLZuASgAIBjCGDhoB0GABUIACS5pEvRoNgKRpdmADmFXhCxp2QuAoDC4qbJEB5fYeEAeAEIBXMFFYwoAGWZbnzTRgdFzcPKAl8GABbGAA+PgBeWN4ABVIIKPY4GHsAJQgINFiAHTB2KKwIUlFlSRk5ShARZmqkAE4qDy00fCQARgAGKjQWwIZEEFqLBs6NXEQhyfwW5n4ackQ2gF8KdGx5gmIyRpp6PEFhUWWRBXzCxubWxAAWACZOmG7el+HRmHGCDMQBwwPN3ksVmtjogAGw7PY4PCEEjkYZ0AEsDhcPhTeoiJTiVRodRaHR6AxGUzmPFoGwUhwhdyeHx+AJBXiMsIRaJxbgKNIZLI5O5FUrlSrVMSwaYiB4jJ4AVgVHy+/UW8rG52plgYs1BSHB/GWpFW6362121H2SKOqOo6KYWHSOGqGD4rF8mgUxUmcDgPrlLXGbQ6wM+mh6SGev1ImomHq0jRB8wAzFQjZCzYhXvCrYiJsjjmizhNGE69GRMHwzLA6XY4ABlDSaDzcmJOVxM8KRGKxAB0PR5CjbMFyME0WWJzHpAEEwBheAAfXgN4nNrzsdZsACqZSEHdCnhHOjUzdigaefT60bDqsQyuofwBg5iSbmUfTxtN0JzAF10+IeDilUojAFKdQ6rwWy8AAZukUS8AA5HA+DsAA1uwiGlKUFwiLw1yiAkvDMAA7swm7gTKaCMIhA7ogAtKQni8GBgisFUChMVAADcUGITowClLwvAJl6SH8H6/FCbwL4wAoiH8NOWBYM4/D8Bo9FRBAGZYWAWzcI0MQjEgoDop8cB2HgaAIFsWxAA=="}
import { codeToHast } from 'shiki'

const hast = await codeToHast('.text-red { color: red; }', {
  lang: 'css',
  theme: 'catppuccin-mocha'
})
```

### 使用 Highlighter

Shiki 提供的[简写函数](#简写函数)是异步执行的，其使用 WASM 并按需加载主题和语言。在某些情况下，你可能需要同步地进行语法高亮，因此 Shiki 提供了 `createHighlighter` 函数来创建一个 Highlighter 实例，之后可同步调用。

其用法与 `codeToHtml` 基本相同，每个主题和语言文件都是动态导入的 ES 模块。注意，为了获得最佳性能，建议**显式列出**所需的主题和语言。

```ts twoslash theme:nord
// @twoslash-cache: {"v":1,"hash":"4d80d468fb52d3edc15115931ba8569f4e8380b4269656d39f5844629a40ba98","data":"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"}
import { createHighlighter } from 'shiki'

// `createHighlighter` 是异步的，它会初始化内部环境
// 并加载指定的主题和语言。
const highlighter = await createHighlighter({
  themes: ['nord'],
  langs: ['javascript'],
})

// 之后可以同步地使用 `highlighter.codeToHtml`
// 调用已加载的主题和语言。
const code = highlighter.codeToHtml('const a = 1', {
  lang: 'javascript',
  theme: 'nord'
})
```

:::info 重要提示
Highlighter 实例应作为**长生命周期的单例**使用。建议在某处缓存该实例，并在整个应用中复用。应该避免在高频调用的函数或循环中反复调用 `createHighlighter`。

若在 Node.js 环境中运行，推荐使用 [简写函数](#简写函数)，它会自动管理 Highlighter 实例以及主题和语言的动态加载。
:::

此外，如果希望在 Highlighter 创建后加载主题或语言，可以使用 `loadTheme` 和 `loadLanguage` 方法。

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"3115a9221d49580f2eafecd5e854af201485210a0ca7ee2c322d7d3680f4bbda","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808BjCMONAAnwEsBzfAG174apROwASQwXxEBxGGDJdGAHgBCAVzBR+MKABkAhmB4bDPGBXabtuqABV8MALYwAfJRBtDpBogBMAAxUuiZo+EgAjJFUaD4WfgRSQiKegopRVIz4PoaMqYgAbAC+FOjYuIgExGSeNPR4ABRYpBA4vhgAlOwAytwA1lwAkmAiYIb86lo6ekYmZhZWNjMOTq5uAHT8EIarLjBijRvH4ftwh8t2jvvsAD7s164jWBoc9wA64Cwwn53IALrdAC8bnYAAVWs4uHAYCoiBAuFAPFQoBBGAgqvodlB2IZ2KdXPiIPinJxkjIyFY4MT+IYROwuBxGMZ2AAjGDsDQwnFwDBgbKtSBc/gYDaeby+JAAZn8IQUPHCSAAnLF4jBEttdo9cCEuBlEDEQNlcvlagaABylco4PCEEjkWJ0RLMVgcbh8aTCMhiSQelJkeSKUjKKa2WbGUzmSzWaZXNbucVxSVFACscrCEQNhqTCVt5K9DpA6UqsqNOVIeQKJTK1AqtpqhfqiWarXamG6fS4gxGYwmoZWc0jixjYb26y22MHCwO7COx1pJnOs8u4fmUbu7CnUeerw3PRwjC4Ey3Fj+gPYIPBkOhsPhiORIFR6LwWN2uPYC6HHLQxNOZL9FKkFSNJ0mQDJMiy7Kcty7C8vy+CChAwqiomPh+AA7Oh6YKpmkSljm6p4JqBgRtOaR6iWWTlpWZqRJa/xZNAlQgAA9Cx7CANhKgBfeoAcCqAAVKgC+8YA3HKABkZgAxKoAt9GAABR7zjAA7oYjL/gI/qkBOWrxo0ADkRCMvAMIALSemgWmdLJhgKUp7oqYB6kkWuFjaeicCmZ4rhxEgoBOgocBcCweBoAgxTFEAA==="}
import { createHighlighter } from 'shiki'

const highlighter = await createHighlighter({ themes: [], langs: [] })
// ---cut---
// 创建后加载主题和语言
await highlighter.loadTheme('vitesse-light')
await highlighter.loadLanguage('css')
```

自 Shiki v1.0 起，要求所有主题和语言必须显式加载。

```ts theme:slack-dark twoslash
// @twoslash-cache: {"v":1,"hash":"dfbe2ab3327f1446728a88bc8e27128f4ef98acfc21358c70d4e14f39507bbed","data":"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"}
import { createHighlighter } from 'shiki'

const highlighter = await createHighlighter({
  themes: ['slack-dark'],
  langs: ['css']
})

highlighter.codeToHtml(
  'const a = 1',
  { lang: 'javascript', theme: 'slack-dark' }
)
// @error: 抛出错误，`javascript` 未加载

await highlighter.loadLanguage('javascript') // 加载该语言

// 现在可以正常工作
```

如果希望一次性加载所有主题和语言（并不推荐），可以遍历 `bundledLanguages` 和 `bundledThemes` 中的所有键。

```ts twoslash theme:poimandres
// @twoslash-cache: {"v":1,"hash":"dd8d8483513c7af7c69f023dcf019990d5e778ee8dcb9c1d2efae892eb82698e","data":"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="}
import { bundledLanguages, bundledThemes, createHighlighter } from 'shiki'

const highlighter = await createHighlighter({
  themes: Object.keys(bundledThemes),
  langs: Object.keys(bundledLanguages),
})

highlighter.codeToHtml('const a = 1', {
  lang: 'javascript',
  theme: 'poimandres'
})
```

### 细粒捆绑预设

导入 `shiki` 时，所有主题和语言都会作为异步代码块被打包。通常情况下，只要你不使用它们，它们就不会被加载，因此不需要考虑。但在某些场景下你希望控制打包的内容，你可以使用核心模块自行组合打包。

更多细节请参阅[细粒捆绑预设](/guide/bundles#fine-grained-bundle)。

### 捆绑预设

我们也提供了一些预配置的包方案，便于直接使用，详情请见[捆绑预设](/guide/bundles)。

### 使用 CJS

`shiki` 仅以 ESM 格式发布，以减小包体积。但你仍然可以在 CJS 中使用，因为 Node.js 支持在 CJS 中动态导入 ESM 模块。

例如，以下 ESM 代码：

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"31cb8c24a5b8abe4997aea7d1bb33ae1612eeee20ef6f40600bdbb3b8f6a55f7","data":"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"}
// ESM
import { createHighlighter } from 'shiki'

async function main() {
  const highlighter = await createHighlighter({
    themes: ['vitesse-dark'],
    langs: ['javascript'],
  })

  const code = highlighter.codeToHtml('const a = 1', {
    theme: 'vitesse-dark',
    lang: 'javascript',
  })
}
```

可以改写为 CJS：

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"8ac7891a4f3b0493e702f79097cb3e4f9dfcfb7e469a473745ad3383b28cb3cc","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AzAVzAGM0BLCMAAgFsAhpzAAKAJSJeABVIR+nODAA8RCJygA+SiDhpBpBogBMxqgBsYYAOZp8SACxV9pazCMghIneZG5EAIxUbPgGghxkSAEArAC+FOjY/gTEkc50Hmw8erxspDCCNAASnNb4vmU0pFIAwvmFMCVlFfhVAGLhaBCkGMoAQqxQllAAMoI2zIJuFLwDYEMwUAAq+DD8MNpUegZGDkEgljZ2UQDszgZumfXFpeW3VT5+SGYgIWER5IEADPGJOHiEEjkdL0PBZMA5fC3FpVKRNO6VMgAcSsZE4bH6g2GYwmUxgMzmC2Wq3Wm10LiMAE4nAcrLZ7IF9i5LgDofc0gcnogaW9SJ1IogABy/ahJAGpYHUDJg7JoXLXRpsxHVXiiCBYLjZKSE4bwmFkADyGu4EMx82x42sk2msyxixWaw24l4AF5NDI5AolMo9ezSCiwGiMTrFjirXiCXbiY7NGTtoYogEaYd6adzq53GCFb7lY9A45gqE+R9nsKEqL/ogUkCdDRQVXRFg5DhDBhnSGoDnWobjdkzUSw9b8bbzfaSRsAHR2R1wKSiB3rACSYCwzDlAB9eAAdcA8GA73ibgDKaFIImsI04VUE5gAqmATf3hgvh3ozzZNOJkABdHRQCBsAgVYvrw+TWIo+iamAtZTEByDICAsCMIIzDmAwVA/iA37flsFJRAAzIKFh0sciAAGzpiyVbTusCAWFy0SFu8DzciKmCVtWHJ1h4jbNmQmDtlGXZVEaUFwE+oaWkOkajtGpITuYlqzqqg54suq4brwR44GwnA3qpbiHlpp7npe153g+PASaMUkRrwb7np+mFUP+gF4AZMCgTA4HbFBMHWHBCFIShaE6Jh2G4TsURkURtJHAyjHUBcmZVopNh0Zy+bkUxxYsQ4bFilWgJcdKVbgjkWSwFIDk2Do8ZGMYXyJSmpE0syKWvNAuD0VllI5fynxln8yTFZK3EyhCcpQs0fpwkq3b+qiZ7BlGHkyUSL5xnhJgBC8LUMgETLJR400Igteb+H1rxFgNURxOW7EjRKtalSAvHqvxba8MJyJLei1lrSOG3jpoE6VTASwQEUaD8OYc7g9VJk2DM6pibUXWQ0Ugh6KJJriR2gMdptzpuvZSPWH+AFASAKJTfNNBQLkXW8CI31LAAsiMZPvhTkUJiYxjJiRB1fJRHXg5jMPmBdSBXbyt0mCcBUcaNL31m9TYfa2zo1F1uPZEe56WC+1mbVO45SC+ABK3kQXyUEAIJgBgRknjzZlkDe96PkT44zDV1hbVFJjRBRcWpogiXtR4NHdZl/gBKL13MQK+UPYVnFja970tgJvBpdYUg7gAVoIRDY3knAajudXbcYgr4cR8UFklGYeAXMuMv1JasThnWwHgAD0g+8DUABSR5bmA2MYOwvAsOwUECMIYjOsAU+8Ezk28MA8oFDcM3KrwsSurwggAO7CHKnD8Fg3RoKIADkcBQgA1pwj/iFPG9b5C9NkKfC+V894NB+qQUQ68+Cb14LHZSyBH5ECvPAJQABaKABhX6Pxwj/TeBc4GP1LuXOAlcNRYIoD/WIX8wA/3KnKcGp9Tr6lIGDDGUMpZP1oWfU+ARH4zEgdAmBFteAIKQXAVB6DSCYPIVA3BlopAELLhXM8pCKFUNiDodY+gkCgAyFYOAJo8BoAQLEWIQA=="}
// CJS
async function main() {
  const { createHighlighter } = await import('shiki')

  const highlighter = await createHighlighter({
    themes: ['vitesse-dark'],
    langs: ['javascript'],
  })

  const code = highlighter.codeToHtml('const a = 1', {
    theme: 'vitesse-dark',
    lang: 'javascript'
  })
}
```

### 使用 CDN

若想通过 CDN 在浏览器中使用 `shiki`，可以使用 [esm.run](https://esm.run) 或 [esm.sh](https://esm.sh)。

```html theme:rose-pine
<body>
  <div id="foo"></div>

  <script type="module">
    // 请务必指定确切版本
    import { codeToHtml } from 'https://esm.sh/shiki@3.0.0'
    // 或
    // import { codeToHtml } from 'https://esm.run/shiki@3.0.0'

    const foo = document.getElementById('foo')
    foo.innerHTML = await codeToHtml('console.log("Hi, Shiki on CDN :)")', {
      lang: 'js',
      theme: 'rose-pine'
    })
  </script>
</body>
```

这种方式效率很高，仅按需加载所需的语言和主题。以上代码片段只会发起四个请求（`shiki`、`@shikijs/themes/vitesse-light`、`@shikijs/langs/javascript`、`shiki/wasm.mjs`），总共传输约 200KB 数据。

[演示](https://jsfiddle.net/t7brz23v/)

### Cloudflare Workers

Cloudflare Workers [不支持从二进制数据初始化 WebAssembly](https://community.cloudflare.com/t/fixed-cloudflare-workers-slow-with-moderate-sized-webassembly-bindings/184668/3)，因此默认的 WASM 构建无法工作。你需要将 WASM 文件作为资源上传并直接导入。

同时，也建议使用[细粒捆绑预设](#细粒捆绑预设)方法来减小包体积。

```ts twoslash theme:nord
// @twoslash-cache: {"v":1,"hash":"c2d8a498fd70b8a8cd9136da187728055ffe92f90fee5e7c1aa2d2d8f4f4e08a","data":"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"}
// @noErrors
import js from '@shikijs/langs/javascript'
import nord from '@shikijs/themes/nord'
import { createHighlighterCore, loadWasm } from 'shiki/core'

// 将 WASM 作为资源导入
await loadWasm(import('shiki/onig.wasm'))

export default {
  async fetch() {
    const highlighter = await createHighlighterCore({
      themes: [nord],
      langs: [js],
    })

    return new Response(highlighter.codeToHtml('console.log(\'shiki\');', {
      theme: 'nord',
      lang: 'js'
    }))
  },
}
```
